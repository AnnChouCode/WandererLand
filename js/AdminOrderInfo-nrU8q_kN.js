import{s as v}from"./statusStore-ZshnCoww.js";import{u as O}from"./adminOrderStore-Nz-3i78Y.js";import{m as x,b as I}from"./pinia-D6A4allF.js";import{T as w}from"./ToastComponent-72Vp0YOP.js";import{d as y}from"./vue-loading-overlay-nDy6RxjO.js";import{_ as k}from"./index-DedpZ7u7.js";import{a_ as u,aR as i,a5 as r,a6 as s,ba as o,aG as m,ad as h,a4 as c,L as b,aY as S,ae as g,bx as B,aI as T}from"./@vue-zaZYt_0T.js";import"./axios-xY6ymfx7.js";import"./sweetalert2-NwvYGOW7.js";import"./@ckeditor-bzq-HQy0.js";import"./vue-zaw7FvyG.js";import"./vue-axios-1bbP-7uc.js";import"./vue-sweetalert2-HUKuUMJw.js";import"./vee-validate-yOM-A2XF.js";import"./@vee-validate-vwB3goxc.js";import"./bootstrap-Lpi9Oc84.js";import"./@popperjs-kvWuk1nc.js";/* empty css                        */import"./aos-ZvF7bt_9.js";import"./vue-router--ANrfSlZ.js";var C={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const L=y.useLoading(),A=O(),{VITE_API:P,VITE_PATH:D}=C,E={data(){return{tempOrderInfo:{},total:0,swalQuestionWithBootstrapButtons:null,swalInfoCheckWithBootstrapButtons:null}},methods:{...x(v,["addMsg"]),getOrderInfo(e){const n=A.currentOrderList.filter(t=>t.id===e),d={...n[0],hasOwnProperty(){return!1}};Object.prototype.hasOwnProperty.call(d,"is_shipping")?this.tempOrderInfo=n[0]:this.tempOrderInfo={...n[0],is_shipping:!1},this.getTotal()},getTotal(){const e=Object.values(this.tempOrderInfo.products);this.total=e.reduce((n,d)=>n+d.total,0)},updateOrder(e,n){const d=`${P}/api/${D}/admin/order/${e.id}`,f={updatePaid:"更改為「已付款」",updateShipping:"更改為「已出貨」"};this.swalQuestionWithBootstrapButtons.fire({title:`確定要更改為${f[n]}嗎？`,icon:"question",text:"這個動作無法復原",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"確認更改"}).then(t=>{if(t.isConfirmed){const a=L.show(),p=Date.now();n==="updatePaid"&&(e.is_paid=!e.is_paid,e.paid_date=Math.floor(p/1e3)),n==="updateShipping"&&(e.is_shipping=!e.is_shipping,e.shipping_date=Math.floor(p/1e3)),this.axios.put(d,{data:e}).then(_=>{this.addMsg("bi-info-circle","訂單狀態已更新")}).catch(_=>{this.swalInfoCheckWithBootstrapButtons.fire({icon:"error",text:_.response.data.message,confirmButtonText:"確認"})}).finally(a.hide())}})}},computed:{...I(O)},components:{ToastComponent:w},mounted(){const e=this.$route.params.id;this.getOrderInfo(e),this.swalQuestionWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-outline-default",cancelButton:"m-1 btn btn-default"},buttonsStyling:!1}),this.swalInfoCheckWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-default"},buttonsStyling:!1})}},N={class:"overflow-y-scroll scrollbar-y-hide vh-100"},V={class:"py-4 py-md-7 fw-bold"},W={class:"d-flex gap-2"},M={key:0,class:"text-info"},R={key:1,class:"text-danger"},j={key:0,class:"text-info"},q={key:1,class:"text-danger"},Q={class:"row g-3"},z={key:0,class:"col-md-7"},H={class:"row flex-column g-3"},U={class:"col"},F={class:"border border-1 rounded"},G={class:"row"},Y={class:"col"},J={class:"p-5"},K=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單總金額",-1),X={class:"mb-2 fs-2 fw-bold"},Z=s("span",{class:"d-block d-sm-inline"},"「已付款」",-1),$={class:"col"},ss={class:"p-5"},ts=s("h3",{class:"mb-2 fs-5 fw-bold"},"商品總數",-1),os={class:"mb-2 fs-2 fw-bold"},es=s("hr",{class:"m-0"},null,-1),ns={class:"p-5"},is={class:"list-unstyled"},rs={class:"row"},ls={class:"col-lg-6"},ds={class:"col-lg-6"},cs={class:"row"},as={class:"col-6"},ps={class:"text-end text-lg-start"},_s={class:"col-6"},hs={class:"text-end"},fs={class:"row fw-bold text-end"},us=s("div",{class:"col-xl-6"},null,-1),ms={class:"col-xl-6"},bs={class:"row"},gs=s("div",{class:"col"},[s("p",{class:"text-info"},"小計"),s("p",{class:"text-info"},"coupon 折抵")],-1),Os={class:"col"},vs={class:"text-info"},xs={class:"text-danger"},Is=s("hr",null,null,-1),ws={class:"row"},ys=s("div",{class:"col"},[s("p",{class:"fs-5"},"總金額")],-1),ks={class:"col"},Ss={class:"fs-5"},Bs=s("hr",{class:"m-0"},null,-1),Ts={class:"p-5"},Cs=s("h3",{class:"mb-2 fs-5 fw-bold"},"顧客備註",-1),Ls={class:"col"},As={class:"p-5 border border-1 rounded"},Ps=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單紀錄",-1),Ds={class:"d-flex flex-column gap-3 ps-3"},Es={key:0},Ns={class:"mb-1 text-info fs-info"},Vs=s("p",{class:"fw-bold"}," 出貨日期 ",-1),Ws={key:1},Ms={class:"mb-1 text-info fs-info"},Rs=s("p",{class:"fw-bold"}," 付款日期 ",-1),js={class:"mb-1 text-info fs-info"},qs=s("p",{class:"fw-bold"}," 訂單產生 ",-1),Qs={class:"col-md-5"},zs={key:0,class:"row flex-column g-3"},Hs={class:"col"},Us={class:"border border-1 rounded"},Fs=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-person"})]),h("顧客資訊 ")],-1),Gs=s("hr",null,null,-1),Ys={class:"pb-3 px-3"},Js={class:"fs-5"},Ks={class:"text-info list-unstyled"},Xs={class:"col"},Zs={class:"border border-1 rounded"},$s=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-box-seam"})]),h("宅配地址 ")],-1),st=s("hr",null,null,-1),tt={class:"pb-3 px-3"},ot={class:"fs-5"},et={class:"text-info list-unstyled"};function nt(e,n,d,f,t,a){const p=u("router-link"),_=u("ToastComponent");return i(),r(b,null,[s("div",N,[s("h2",V,"訂單編號："+o(t.tempOrderInfo.id),1),s("div",W,[s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",t.tempOrderInfo.is_paid?"border-info":"border-danger"])},[t.tempOrderInfo.is_paid?(i(),r("span",M,"已付款")):(i(),r("span",R,"未付款"))],2),s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",t.tempOrderInfo.is_shipping?"border-info":"border-danger"])},[t.tempOrderInfo.is_shipping?(i(),r("span",j,"已出貨")):(i(),r("span",q,"未出貨"))],2)]),s("div",Q,[t.tempOrderInfo.products?(i(),r("div",z,[s("div",H,[s("div",U,[s("div",F,[s("div",G,[s("div",Y,[s("div",J,[K,s("p",X,"NT$ "+o(t.tempOrderInfo.total),1),t.tempOrderInfo.is_paid?c("",!0):(i(),r("button",{key:0,class:"btn btn-default",onClick:n[0]||(n[0]=l=>a.updateOrder(t.tempOrderInfo,"updatePaid"))},[h("更改為"),Z]))])]),s("div",$,[s("div",ss,[ts,s("p",os,o(Object.keys(t.tempOrderInfo.products).length),1),t.tempOrderInfo.is_shipping?c("",!0):(i(),r("button",{key:0,class:"btn btn-default",onClick:n[1]||(n[1]=l=>a.updateOrder(t.tempOrderInfo,"updateShipping"))},"出貨"))])])]),es,s("div",ns,[s("ul",is,[(i(!0),r(b,null,S(t.tempOrderInfo.products,l=>(i(),r("li",{key:l.id,class:"mb-3 pb-3 border-bottom"},[s("div",rs,[s("div",ls,[g(p,{to:`/productinfo/${l.product.id}`,target:"_blank",class:"d-flex gap-3 link-hover-decoration fw-bold"},{default:B(()=>[s("div",{style:T([{height:"50px"},{backgroundImage:`url(${l.product.imageUrl})`}]),class:"bg-img-contain bg-img-center bg-img-norepeat ratio-1x1"},null,4),h(" "+o(l.product.title),1)]),_:2},1032,["to"])]),s("div",ds,[s("div",cs,[s("div",as,[s("p",ps,"NT$ "+o(l.product.price.toLocaleString())+" x "+o(l.qty),1)]),s("div",_s,[s("p",hs,"NT$ "+o(l.total.toLocaleString()),1)])])])])]))),128))]),s("div",fs,[us,s("div",ms,[s("div",bs,[gs,s("div",Os,[s("p",vs,"NT$ "+o(t.total.toLocaleString()),1),s("p",xs,"- "+o((t.total-t.tempOrderInfo.total).toLocaleString()),1)])]),Is,s("div",ws,[ys,s("div",ks,[s("p",Ss,"NT$ "+o(t.tempOrderInfo.total.toLocaleString()),1)])])])])]),Bs,s("div",Ts,[Cs,s("p",null,o(t.tempOrderInfo.message),1)])])]),s("div",Ls,[s("div",As,[Ps,s("ul",Ds,[t.tempOrderInfo.shipping_date?(i(),r("li",Es,[s("p",Ns,o(new Date(t.tempOrderInfo.shipping_date*1e3).toLocaleString()),1),Vs])):c("",!0),t.tempOrderInfo.paid_date?(i(),r("li",Ws,[s("p",Ms,o(new Date(t.tempOrderInfo.paid_date*1e3).toLocaleString()),1),Rs])):c("",!0),s("li",null,[s("p",js,o(new Date(t.tempOrderInfo.create_at*1e3).toLocaleString()),1),qs])])])])])])):c("",!0),s("div",Qs,[t.tempOrderInfo.user?(i(),r("div",zs,[s("div",Hs,[s("div",Us,[Fs,Gs,s("div",Ys,[s("p",Js,o(t.tempOrderInfo.user.name),1),s("ul",Ks,[s("li",null,o(t.tempOrderInfo.user.email),1),s("li",null,o(t.tempOrderInfo.user.tel),1),s("li",null,o(t.tempOrderInfo.user.address),1)])])])]),s("div",Xs,[s("div",Zs,[$s,st,s("div",tt,[s("p",ot,o(t.tempOrderInfo.user.name),1),s("ul",et,[s("li",null,o(t.tempOrderInfo.user.address),1),s("li",null,o(t.tempOrderInfo.user.tel),1)])])])])])):c("",!0)])])]),g(_,{adminOrderState:e.toastState,adminOrderAction:e.doAction},null,8,["adminOrderState","adminOrderAction"])],64)}const kt=k(E,[["render",nt]]);export{kt as default};
