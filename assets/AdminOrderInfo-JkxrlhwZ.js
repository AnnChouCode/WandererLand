import{s as v}from"./statusStore-rfGMzh5K.js";import{u as O}from"./adminOrderStore-CN5ji0dn.js";import{_ as x,q as I,m as w,M as y,r as u,o as i,c as l,b as s,t as o,n as m,g as h,h as c,F as b,d as k,e as g,f as S,T as B}from"./index-oG8AEEVe.js";import{t as T}from"./toastComponent-F8SW6iF6.js";import"./sweetalert2.all-4ErotOK5.js";var C={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const L=I.useLoading(),A=O(),{VITE_API:P,VITE_PATH:D}=C,E={data(){return{tempOrderInfo:{},total:0,swalQuestionWithBootstrapButtons:null,swalInfoCheckWithBootstrapButtons:null}},methods:{...w(v,["addMsg"]),getOrderInfo(e){const n=A.currentOrderList.filter(t=>t.id===e),r={...n[0],hasOwnProperty(){return!1}};Object.prototype.hasOwnProperty.call(r,"is_shipping")?this.tempOrderInfo=n[0]:this.tempOrderInfo={...n[0],is_shipping:!1},this.getTotal()},getTotal(){const e=Object.values(this.tempOrderInfo.products);this.total=e.reduce((n,r)=>n+r.total,0)},updateOrder(e,n){const r=`${P}/api/${D}/admin/order/${e.id}`,f={updatePaid:"更改為「已付款」",updateShipping:"更改為「已出貨」"};this.swalQuestionWithBootstrapButtons.fire({title:`確定要更改為${f[n]}嗎？`,icon:"question",text:"這個動作無法復原",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"確認更改"}).then(t=>{if(t.isConfirmed){const a=L.show(),_=Date.now();n==="updatePaid"&&(e.is_paid=!e.is_paid,e.paid_date=Math.floor(_/1e3)),n==="updateShipping"&&(e.is_shipping=!e.is_shipping,e.shipping_date=Math.floor(_/1e3)),this.axios.put(r,{data:e}).then(p=>{this.addMsg("bi-info-circle","訂單狀態已更新")}).catch(p=>{this.swalInfoCheckWithBootstrapButtons.fire({icon:"error",text:p.response.data.message,confirmButtonText:"確認"})}).finally(a.hide())}})}},computed:{...y(O)},components:{toastComponent:T},mounted(){const e=this.$route.params.id;this.getOrderInfo(e),this.swalQuestionWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-outline-default",cancelButton:"m-1 btn btn-default"},buttonsStyling:!1}),this.swalInfoCheckWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-default"},buttonsStyling:!1})}},N={class:"overflow-y-scroll scrollbar-y-hide vh-100"},V={class:"py-4 py-md-7 fw-bold"},W={class:"d-flex gap-2"},M={key:0,class:"text-info"},q={key:1,class:"text-danger"},j={key:0,class:"text-info"},Q={key:1,class:"text-danger"},R={class:"row g-3"},z={key:0,class:"col-md-7"},F={class:"row flex-column g-3"},H={class:"col"},U={class:"border border-1 rounded"},G={class:"row"},J={class:"col"},K={class:"p-5"},X=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單總金額",-1),Y={class:"mb-2 fs-2 fw-bold"},Z=s("span",{class:"d-block d-sm-inline"},"「已付款」",-1),$={class:"col"},ss={class:"p-5"},ts=s("h3",{class:"mb-2 fs-5 fw-bold"},"商品總數",-1),os={class:"mb-2 fs-2 fw-bold"},es=s("hr",{class:"m-0"},null,-1),ns={class:"p-5"},is={class:"list-unstyled"},ls={class:"row"},ds={class:"col-lg-6"},rs={class:"col-lg-6"},cs={class:"row"},as={class:"col-6"},_s={class:"text-end text-lg-start"},ps={class:"col-6"},hs={class:"text-end"},fs={class:"row fw-bold text-end"},us=s("div",{class:"col-xl-6"},null,-1),ms={class:"col-xl-6"},bs={class:"row"},gs=s("div",{class:"col"},[s("p",{class:"text-info"},"小計"),s("p",{class:"text-info"},"coupon 折抵")],-1),Os={class:"col"},vs={class:"text-info"},xs={class:"text-danger"},Is=s("hr",null,null,-1),ws={class:"row"},ys=s("div",{class:"col"},[s("p",{class:"fs-5"},"總金額")],-1),ks={class:"col"},Ss={class:"fs-5"},Bs=s("hr",{class:"m-0"},null,-1),Ts={class:"p-5"},Cs=s("h3",{class:"mb-2 fs-5 fw-bold"},"顧客備註",-1),Ls={class:"col"},As={class:"p-5 border border-1 rounded"},Ps=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單紀錄",-1),Ds={class:"d-flex flex-column gap-3 ps-3"},Es={key:0},Ns={class:"mb-1 text-info fs-info"},Vs=s("p",{class:"fw-bold"}," 出貨日期 ",-1),Ws={key:1},Ms={class:"mb-1 text-info fs-info"},qs=s("p",{class:"fw-bold"}," 付款日期 ",-1),js={class:"mb-1 text-info fs-info"},Qs=s("p",{class:"fw-bold"}," 訂單產生 ",-1),Rs={class:"col-md-5"},zs={key:0,class:"row flex-column g-3"},Fs={class:"col"},Hs={class:"border border-1 rounded"},Us=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-person"})]),h("顧客資訊 ")],-1),Gs=s("hr",null,null,-1),Js={class:"pb-3 px-3"},Ks={class:"fs-5"},Xs={class:"text-info list-unstyled"},Ys={class:"col"},Zs={class:"border border-1 rounded"},$s=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-box-seam"})]),h("宅配地址 ")],-1),st=s("hr",null,null,-1),tt={class:"pb-3 px-3"},ot={class:"fs-5"},et={class:"text-info list-unstyled"};function nt(e,n,r,f,t,a){const _=u("router-link"),p=u("toastComponent");return i(),l(b,null,[s("div",N,[s("h2",V,"訂單編號："+o(t.tempOrderInfo.id),1),s("div",W,[s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",t.tempOrderInfo.is_paid?"border-info":"border-danger"])},[t.tempOrderInfo.is_paid?(i(),l("span",M,"已付款")):(i(),l("span",q,"未付款"))],2),s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",t.tempOrderInfo.is_shipping?"border-info":"border-danger"])},[t.tempOrderInfo.is_shipping?(i(),l("span",j,"已出貨")):(i(),l("span",Q,"未出貨"))],2)]),s("div",R,[t.tempOrderInfo.products?(i(),l("div",z,[s("div",F,[s("div",H,[s("div",U,[s("div",G,[s("div",J,[s("div",K,[X,s("p",Y,"NT$ "+o(t.tempOrderInfo.total),1),t.tempOrderInfo.is_paid?c("",!0):(i(),l("button",{key:0,class:"btn btn-default",onClick:n[0]||(n[0]=d=>a.updateOrder(t.tempOrderInfo,"updatePaid"))},[h("更改為"),Z]))])]),s("div",$,[s("div",ss,[ts,s("p",os,o(Object.keys(t.tempOrderInfo.products).length),1),t.tempOrderInfo.is_shipping?c("",!0):(i(),l("button",{key:0,class:"btn btn-default",onClick:n[1]||(n[1]=d=>a.updateOrder(t.tempOrderInfo,"updateShipping"))},"出貨"))])])]),es,s("div",ns,[s("ul",is,[(i(!0),l(b,null,k(t.tempOrderInfo.products,d=>(i(),l("li",{key:d.id,class:"mb-3 pb-3 border-bottom"},[s("div",ls,[s("div",ds,[g(_,{to:`/productinfo/${d.product.id}`,target:"_blank",class:"d-flex gap-3 link-hover-decoration fw-bold"},{default:S(()=>[s("div",{style:B([{height:"50px"},{backgroundImage:`url(${d.product.imageUrl})`}]),class:"bg-img-contain bg-img-center bg-img-norepeat ratio-1x1"},null,4),h(" "+o(d.product.title),1)]),_:2},1032,["to"])]),s("div",rs,[s("div",cs,[s("div",as,[s("p",_s,"NT$ "+o(d.product.price.toLocaleString())+" x "+o(d.qty),1)]),s("div",ps,[s("p",hs,"NT$ "+o(d.total.toLocaleString()),1)])])])])]))),128))]),s("div",fs,[us,s("div",ms,[s("div",bs,[gs,s("div",Os,[s("p",vs,"NT$ "+o(t.total.toLocaleString()),1),s("p",xs,"- "+o((t.total-t.tempOrderInfo.total).toLocaleString()),1)])]),Is,s("div",ws,[ys,s("div",ks,[s("p",Ss,"NT$ "+o(t.tempOrderInfo.total.toLocaleString()),1)])])])])]),Bs,s("div",Ts,[Cs,s("p",null,o(t.tempOrderInfo.message),1)])])]),s("div",Ls,[s("div",As,[Ps,s("ul",Ds,[t.tempOrderInfo.shipping_date?(i(),l("li",Es,[s("p",Ns,o(new Date(t.tempOrderInfo.shipping_date*1e3).toLocaleString()),1),Vs])):c("",!0),t.tempOrderInfo.paid_date?(i(),l("li",Ws,[s("p",Ms,o(new Date(t.tempOrderInfo.paid_date*1e3).toLocaleString()),1),qs])):c("",!0),s("li",null,[s("p",js,o(new Date(t.tempOrderInfo.create_at*1e3).toLocaleString()),1),Qs])])])])])])):c("",!0),s("div",Rs,[t.tempOrderInfo.user?(i(),l("div",zs,[s("div",Fs,[s("div",Hs,[Us,Gs,s("div",Js,[s("p",Ks,o(t.tempOrderInfo.user.name),1),s("ul",Xs,[s("li",null,o(t.tempOrderInfo.user.email),1),s("li",null,o(t.tempOrderInfo.user.tel),1),s("li",null,o(t.tempOrderInfo.user.address),1)])])])]),s("div",Ys,[s("div",Zs,[$s,st,s("div",tt,[s("p",ot,o(t.tempOrderInfo.user.name),1),s("ul",et,[s("li",null,o(t.tempOrderInfo.user.address),1),s("li",null,o(t.tempOrderInfo.user.tel),1)])])])])])):c("",!0)])])]),g(p,{adminOrderState:e.toastState,adminOrderAction:e.doAction},null,8,["adminOrderState","adminOrderAction"])],64)}const at=x(E,[["render",nt]]);export{at as default};
