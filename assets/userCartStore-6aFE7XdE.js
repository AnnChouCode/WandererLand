import{s as l,i as p,j as i}from"./index-SuvShJ5P.js";import{s as r}from"./sweetalert2.all-6q_o9MV5.js";var u={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const n=l.useLoading(),{VITE_API:c,VITE_PATH:d}=u,m=p("cartStore",{state:()=>({cartsList:[],toastState:!0,doAction:null,coupon_code:""}),actions:{addToCart(t,e){const o=n.show(),s=`${c}/api/${d}/cart`,a={data:{product_id:t,qty:e}};i.post(s,a).then(h=>{this.toastState=!this.toastState,this.doAction="addToCart",this.getCartsList()}).catch(h=>{r.fire({icon:"error",text:h.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{o.hide()})},getCartsList(){const t=n.show(),e=`${c}/api/${d}/cart`;i.get(e).then(o=>{this.cartsList=o.data.data}).catch(o=>{r.fire({icon:"error",text:o.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{t.hide()})},updateCart(t){const e=n.show(),o=`${c}/api/${d}/cart/${t.id}`,s={data:{product_id:t.product_id,qty:t.qty}};i.put(o,s).then(a=>{this.toastState=!this.toastState,this.doAction="updateCart",this.getCartsList()}).catch(a=>{r.fire({icon:"error",text:a.response.data.message})}).finally(()=>{e.hide()})},deleteCartItem(t){const e=n.show(),o=`${c}/api/${d}/cart/${t}`;i.delete(o).then(s=>{this.toastState=!this.toastState,this.doAction="deleteCartItem",this.getCartsList()}).catch(s=>{r.fire({icon:"error",text:s.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{e.hide()})},copyCouponCode(t){navigator.clipboard.writeText(t).then(()=>{this.toastState=!this.toastState,this.doAction="copyCouponCode",this.coupon_code=t})},checkCoupon(t){const e=`${c}/api/${d}/coupon`;if(this.cartsList.total!==this.cartsList.final_total){r.fire({title:"已經套用此優惠券",confirmButtonColor:"#333333",confirmButtonText:"確認"});return}const o=n.show(),s={data:{code:t}};i.post(e,s).then(a=>{this.toastState=!this.toastState,this.doAction="useCoupon",this.getCartsList()}).catch(a=>{r.fire({icon:"error",text:a.response.data.message})}).finally(()=>{o.hide()})}}});export{m as c};
