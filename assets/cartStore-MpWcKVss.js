import{Y as l,M as p,O as i}from"./index-pzpS6pyO.js";import{s as r}from"./sweetalert2.all-yD-pxYGR.js";var u={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const d=l.useLoading(),{VITE_API:n,VITE_PATH:c}=u,m=p("cartStore",{state:()=>({cartsList:[],toastState:!0,doAction:null,coupon_code:""}),actions:{addToCart(t,o){const s=d.show(),e=`${n}/api/${c}/cart`,a={data:{product_id:t,qty:o}};i.post(e,a).then(h=>{this.toastState=!this.toastState,this.doAction="addToCart",this.getCartsList()}).catch(h=>{r.fire({icon:"error",text:h.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{s.hide()})},getCartsList(){const t=`${n}/api/${c}/cart`;i.get(t).then(o=>{this.cartsList=o.data.data,console.log(this.cartsList)}).catch(o=>{r.fire({icon:"error",text:o.response.data.message,confirmButtonColor:"#333333"})})},updateCart(t){const o=d.show(),s=`${n}/api/${c}/cart/${t.id}`,e={data:{product_id:t.product_id,qty:t.qty}};i.put(s,e).then(a=>{this.toastState=!this.toastState,this.doAction="updateCart",this.getCartsList()}).catch(a=>{r.fire({icon:"error",text:a.response.data.message})}).finally(()=>{o.hide()})},deleteCartItem(t){const o=d.show(),s=`${n}/api/${c}/cart/${t}`;i.delete(s).then(e=>{this.toastState=!this.toastState,this.doAction="deleteCartItem",this.getCartsList()}).catch(e=>{r.fire({icon:"error",text:e.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{o.hide()})},copyCouponCode(t){navigator.clipboard.writeText(t).then(()=>{this.toastState=!this.toastState,this.doAction="copyCouponCode",this.coupon_code=t})},checkCoupon(t){console.log("checkCoupon");const o=`${n}/api/${c}/coupon`;if(this.cartsList.total!==this.cartsList.final_total){r.fire({title:"已經套用此優惠券",confirmButtonColor:"#333333",confirmButtonText:"確認"});return}const s=d.show(),e={data:{code:t}};i.post(o,e).then(a=>{this.toastState=!this.toastState,this.doAction="useCoupon",this.getCartsList()}).catch(a=>{r.fire({icon:"error",text:a.response.data.message})}).finally(()=>{s.hide()})}}});export{m as c};
