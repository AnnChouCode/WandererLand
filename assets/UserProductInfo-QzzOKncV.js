import{u as b}from"./userProductStore-J3csPZxz.js";import{f as x}from"./favoriteStore-3PBrHaKn.js";import{c as y}from"./userCartStore-6ARb1eo5.js";import{_ as S,m as h,a as I,r as v,o as i,c as l,b as t,F as f,d as w,h as d,t as r,e as u,i as A,f as _,l as k,g as O}from"./index-k5AC9q_x.js";import{b as C}from"./btnFavorite-nI0QH5Qp.js";import"./sweetalert2.all-lH04TIZP.js";import"./statusStore-llTnkdEs.js";var N={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:q,VITE_PATH:R}=N,T={data(){return{currentProductId:null,product:{},qty:1,tempRelatedAllProducts:[],relatedProducts:[],artistInfo:{},quantityInCart:""}},watch:{cartsList(){this.getAvailableProductNum(this.currentProductId)},$route(){this.initPageInfo()}},methods:{...h(b,["getAllProducts"]),...h(y,["addToCart","getCartsList"]),...h(x,["recentlyViewed"]),changeImage(e){this.product.currentImage=this.product.imagesStock[e]},getCurrentProduct(e){const n=`${q}/api/${R}/product/${e}`;return this.axios.get(n).then(c=>{const a=c.data.product;return this.product={productInfo:a,currentImage:a.imageUrl},a.imagesUrl&&(this.product.imagesStock=[a.imageUrl,...a.imagesUrl]),this.recentlyViewed(a),a.artist}).catch(c=>console.log(c.response.data.message))},getRelatedProducts(e,n){this.tempRelatedAllProducts=this.sortNewest.newestProduct.filter(c=>c.artist===e&&c.id!==n),this.tempRelatedAllProducts.length||(this.tempRelatedAllProducts=this.sortNewest.newestProduct.filter(c=>c.group===this.product.productInfo.group)),this.relatedProducts=this.tempRelatedAllProducts.slice(0,3)},getArtistInfo(e){this.artistInfo=this.sortNewest.newestArtist.filter(n=>n.title===e)[0]},getAvailableProductNum(e){const n=this.cartsList.carts.filter(c=>c.product_id===e);this.quantityInCart=n.length?n[0].qty:0},async initPageInfo(){try{this.currentProductId=this.$route.params.id;const e=await this.getCurrentProduct(this.currentProductId);await this.getAllProducts(),this.getCartsList(),this.getAvailableProductNum(this.currentProductId),this.getRelatedProducts(e,this.currentProductId),this.getArtistInfo(e)}catch(e){throw console.log("錯誤:",e),e}}},mounted(){this.initPageInfo()},computed:{...I(b,["sortNewest"]),...I(y,["cartsList"])},components:{btnFavorite:C}},V={key:0,class:"container user-page-container"},L={class:"row g-1 g-lg-6"},j={class:"col-12 col-md-8"},E={class:"row"},U={class:"position-relative col-12 col-lg-3"},z={class:"bg-tertiary h-100 overflow-hidden"},B={key:0,class:"position-lg-absolute row gap-0 gap-lg-2 px-2 py-2 py-lg-0 px-lg-auto flex-nowrap flex-lg-column overflow-auto scrollbar-y-hide w-lg-100 h-lg-100"},D=["onClick"],F=["src"],Q={class:"col-12 col-lg-9 order-first order-lg-last flex-shrink-0 content"},H={class:"bg-tertiary ratio-1x1 overflow-hidden"},M=["src","alt"],W={class:"col-12 col-md-4"},G={class:"p-3 p-lg-7 mb-3 mb-md-6 bg-tertiary"},J={class:"d-flex justify-content-between align-items-start mb-5 mb-md-7"},K={class:"mb-2 h6 text-info fw-bold"},X={class:"h5 fw-bold"},Y={class:"lh-base lh-md-lg fs-info text-info"},Z=t("hr",{class:"my-6 text-default"},null,-1),$={class:"accordion accordion-flush",id:"accordionPanelsProductInfo"},tt={class:"accordion-item bg-transparent border-default"},ot=t("h2",{class:"accordion-header",id:"panelsStayOpen-headingSize"},[t("button",{class:"accordion-button text-info fw-bold bg-transparent p-0",type:"button","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapseSize","aria-expanded":"true","aria-controls":"panelsStayOpen-collapseSize",style:{"box-shadow":"none"}}," 作品規格 ")],-1),et={id:"panelsStayOpen-collapseSize",class:"accordion-collapse collapse show","aria-labelledby":"panelsStayOpen-headingSize"},st={class:"accordion-body p-0 pt-4 lh-base lh-md-lg h6 text-info"},nt=t("hr",{class:"my-6 text-default"},null,-1),ct={class:"accordion accordion-flush",id:"accordionPanelsProductInfo"},rt={class:"accordion-item bg-transparent border-default"},it=t("h2",{class:"accordion-header",id:"panelsStayOpen-headingQty"},[t("button",{class:"accordion-button text-info fw-bold bg-transparent p-0",type:"button","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapseQty","aria-expanded":"true","aria-controls":"panelsStayOpen-collapseQty",style:{"box-shadow":"none"}}," 作品版數 ")],-1),at={id:"panelsStayOpen-collapseQty",class:"accordion-collapse collapse show","aria-labelledby":"panelsStayOpen-headingQty"},lt={class:"accordion-body p-0 pt-4 lh-base lh-md-lg h6 text-info"},dt=t("hr",{class:"my-6 text-default"},null,-1),ut={class:"accordion accordion-flush",id:"accordionPanelsProductInfo"},pt={class:"accordion-item bg-transparent"},ht={class:"accordion-header",id:"panelsStayOpen-headingAbout"},ft={class:"accordion-button text-info fw-bold bg-transparent p-0",type:"button","data-bs-toggle":"collapse","data-bs-target":"#panelsStayOpen-collapseAbout","aria-expanded":"true","aria-controls":"panelsStayOpen-collapseAbout",style:{"box-shadow":"none"}},_t={id:"panelsStayOpen-collapseAbout",class:"accordion-collapse collapse","aria-labelledby":"panelsStayOpen-headingOne"},gt={class:"accordion-body p-0 pt-4 lh-base lh-md-lg fs-info text-info"},mt=["disabled"],bt={key:1,class:"container"},yt={class:"py-7 py-md-9"},It={class:"d-flex justify-content-between align-items-center mb-7 mb-md-8"},vt=t("h2",{class:"fs-2 fs-md-1"},"相似作品",-1),wt={class:"row g-3 g-md-8"},Pt={class:"position-relative d-flex justify-content-center align-items-center ratio-1x1 overflow-hidden product-img"},xt=["src","alt"],St=["src"],At={class:"py-3 px-0 px-md-4"},kt={class:"mb-2 fs-info fs-md-5 fw-bold text-default"},Ot={class:"d-flex justify-content-between align-items-center"},Ct={class:"fs-info fs-md-6 text-info"};function Nt(e,n,c,a,o,P){const g=v("btnFavorite"),p=v("router-link");return i(),l(f,null,[o.product.productInfo?(i(),l("div",V,[t("div",L,[t("div",j,[t("div",E,[t("div",U,[t("div",z,[o.product.imagesStock?(i(),l("div",B,[(i(!0),l(f,null,w(o.product.imagesStock,(s,m)=>(i(),l("a",{href:"#",class:"col-3 col-lg-12 ratio-1x1 overflow-hidden",key:"img"+m,onClick:k(qt=>P.changeImage(m),["prevent"])},[t("img",{src:s,alt:"product",class:"object-fit-contain w-100 h-100"},null,8,F)],8,D))),128))])):d("",!0)])]),t("div",Q,[t("div",H,[t("img",{src:o.product.currentImage,alt:o.product.productInfo.title,class:"object-fit-contain w-100 h-100"},null,8,M)])])])]),t("div",W,[t("div",G,[t("div",J,[t("div",null,[t("h3",K,r(o.product.productInfo.artist),1),t("h2",X,r(o.product.productInfo.title),1)]),u(g,{productId:o.product.productInfo.id},null,8,["productId"])]),t("p",Y,r(o.product.productInfo.content),1),Z,t("div",$,[t("div",tt,[ot,t("div",et,[t("div",st,r(o.product.productInfo.size),1)])])]),nt,t("div",ct,[t("div",rt,[it,t("div",at,[t("div",lt,[t("p",null,"剩餘版數 "+r(o.product.productInfo.quantity?o.product.productInfo.quantity-o.quantityInCart:"無限"),1),t("p",null,"總版數 "+r(o.product.productInfo.quantity?o.product.productInfo.quantity:"無限"),1)])])])]),dt,t("div",ut,[t("div",pt,[t("h2",ht,[t("button",ft," 關於 "+r(o.artistInfo.title),1)]),t("div",_t,[t("div",gt,r(o.artistInfo.content),1)])])])]),t("button",{type:"button",class:"position-relative py-2 py-md-3 btn btn-default rounded-0 fw-bold w-100",onClick:n[0]||(n[0]=s=>e.addToCart(o.product.productInfo.id,o.qty)),disabled:o.product.productInfo.quantity-o.quantityInCart===0},"加入購物車．NT$ "+r(o.product.productInfo.price.toLocaleString()),9,mt)])])])):d("",!0),o.relatedProducts.length?(i(),l("div",bt,[t("div",yt,[t("div",It,[vt,o.tempRelatedAllProducts?(i(),A(p,{key:0,to:o.tempRelatedAllProducts.length?`/productlist?artist=${o.artistInfo.title}`:`/productlist?group=${o.product.productInfo.group}`,class:"text-default border-bottom border-default fw-bold fs-info fs-md-6"},{default:_(()=>[O("瀏覽更多")]),_:1},8,["to"])):d("",!0)]),t("div",wt,[(i(!0),l(f,null,w(o.relatedProducts,s=>(i(),l("div",{class:"col-6 col-md-4",key:s.id},[u(p,{to:`/productinfo/${s.id}`},{default:_(()=>[t("div",Pt,[t("img",{src:s.imageUrl,alt:s.title,class:"object-fit-contain w-100 h-100 product-img-up"},null,8,xt),t("img",{src:s.imagesUrl[0],alt:"item.title",class:"position-absolute z-n1 object-fit-contain w-100 h-100 product-img-down"},null,8,St)])]),_:2},1032,["to"]),t("div",At,[u(p,{to:`/productinfo/${s.id}`},{default:_(()=>[t("h3",kt,r(s.title),1)]),_:2},1032,["to"]),t("div",Ot,[t("p",Ct,"NT$ "+r(s.price.toLocaleString()),1),u(g,{productId:s.id},null,8,["productId"])])])]))),128))])])])):d("",!0)],64)}const zt=S(T,[["render",Nt]]);export{zt as default};
