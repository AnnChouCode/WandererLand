import{u as O}from"./adminOrderStore-xMRn0pfL.js";import{_ as v,l as x,M as I,r as f,o as i,c as l,b as s,t as o,n as m,e as h,f as c,F as b,i as w,d as g,w as y,N as S}from"./index-9M2FzS39.js";import{t as k}from"./toastComponent-tLkUYezn.js";import"./sweetalert2.all-skyK9D_h.js";import"./userCartStore-tiAPUQW5.js";var B={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const T=x.useLoading(),C=O(),{VITE_API:L,VITE_PATH:A}=B,N={data(){return{tempOrderInfo:{},total:0,doAction:null,toastState:!0,swalQuestionWithBootstrapButtons:null,swalInfoCheckWithBootstrapButtons:null}},methods:{getOrderInfo(e){const n=C.currentOrderList.filter(t=>t.id===e),r={...n[0],hasOwnProperty(){return!1}};Object.prototype.hasOwnProperty.call(r,"is_shipping")?this.tempOrderInfo=n[0]:this.tempOrderInfo={...n[0],is_shipping:!1},this.getTotal()},getTotal(){const e=Object.values(this.tempOrderInfo.products);this.total=e.reduce((n,r)=>n+r.total,0)},updateOrder(e,n){const r=`${L}/api/${A}/admin/order/${e.id}`,u={updatePaid:"更改為「已付款」",updateShipping:"更改為「已出貨」"};this.swalQuestionWithBootstrapButtons.fire({title:`確定要更改為${u[n]}嗎？`,icon:"question",text:"這個動作無法復原",showCancelButton:!0,cancelButtonText:"取消",confirmButtonText:"確認更改"}).then(t=>{if(t.isConfirmed){const a=T.show(),_=Date.now();n==="updatePaid"&&(e.is_paid=!e.is_paid,e.paid_date=Math.floor(_/1e3)),n==="updateShipping"&&(e.is_shipping=!e.is_shipping,e.shipping_date=Math.floor(_/1e3)),this.axios.put(r,{data:e}).then(p=>{this.toastState=!this.toastState,this.doAction=n}).catch(p=>{this.swalInfoCheckWithBootstrapButtons.fire({icon:"error",text:p.response.data.message,confirmButtonText:"確認"})}).finally(a.hide())}})}},computed:{...I(O)},components:{toastComponent:k},mounted(){const e=this.$route.params.id;this.getOrderInfo(e),this.swalQuestionWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-outline-default",cancelButton:"m-1 btn btn-default"},buttonsStyling:!1}),this.swalInfoCheckWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-default"},buttonsStyling:!1})}},P={class:"overflow-y-scroll scrollbar-y-hide vh-100"},D={class:"py-4 py-md-7 fw-bold"},E={class:"d-flex gap-2"},V={key:0,class:"text-info"},W={key:1,class:"text-danger"},M={key:0,class:"text-info"},j={key:1,class:"text-danger"},q={class:"row g-3"},Q={key:0,class:"col-md-7"},R={class:"row flex-column g-3"},z={class:"col"},F={class:"border border-1 rounded"},H={class:"row"},U={class:"col"},G={class:"p-5"},J=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單總金額",-1),K={class:"mb-2 fs-2 fw-bold"},X=s("span",{class:"d-block d-sm-inline"},"「已付款」",-1),Y={class:"col"},Z={class:"p-5"},$=s("h3",{class:"mb-2 fs-5 fw-bold"},"商品總數",-1),ss={class:"mb-2 fs-2 fw-bold"},ts=s("hr",{class:"m-0"},null,-1),os={class:"p-5"},es={class:"list-unstyled"},ns={class:"row"},is={class:"col-lg-6"},ls={class:"col-lg-6"},ds={class:"row"},rs={class:"col-6"},cs={class:"text-end text-lg-start"},as={class:"col-6"},_s={class:"text-end"},ps={class:"row fw-bold text-end"},hs=s("div",{class:"col-xl-6"},null,-1),us={class:"col-xl-6"},fs={class:"row"},ms=s("div",{class:"col"},[s("p",{class:"text-info"},"小計"),s("p",{class:"text-info"},"coupon 折抵")],-1),bs={class:"col"},gs={class:"text-info"},Os={class:"text-danger"},vs=s("hr",null,null,-1),xs={class:"row"},Is=s("div",{class:"col"},[s("p",{class:"fs-5"},"總金額")],-1),ws={class:"col"},ys={class:"fs-5"},Ss=s("hr",{class:"m-0"},null,-1),ks={class:"p-5"},Bs=s("h3",{class:"mb-2 fs-5 fw-bold"},"顧客備註",-1),Ts={class:"col"},Cs={class:"p-5 border border-1 rounded"},Ls=s("h3",{class:"mb-2 fs-5 fw-bold"},"訂單紀錄",-1),As={class:"d-flex flex-column gap-3 ps-3"},Ns={key:0},Ps={class:"mb-1 text-info fs-info"},Ds=s("p",{class:"fw-bold"}," 出貨日期 ",-1),Es={key:1},Vs={class:"mb-1 text-info fs-info"},Ws=s("p",{class:"fw-bold"}," 付款日期 ",-1),Ms={class:"mb-1 text-info fs-info"},js=s("p",{class:"fw-bold"}," 訂單產生 ",-1),qs={class:"col-md-5"},Qs={key:0,class:"row flex-column g-3"},Rs={class:"col"},zs={class:"border border-1 rounded"},Fs=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-person"})]),h("顧客資訊 ")],-1),Hs=s("hr",null,null,-1),Us={class:"pb-3 px-3"},Gs={class:"fs-5"},Js={class:"text-info list-unstyled"},Ks={class:"col"},Xs={class:"border border-1 rounded"},Ys=s("h3",{class:"pt-3 px-3 fw-bold fs-5"},[s("span",{class:"me-2"},[s("i",{class:"bi bi-box-seam"})]),h("宅配地址 ")],-1),Zs=s("hr",null,null,-1),$s={class:"pb-3 px-3"},st={class:"fs-5"},tt={class:"text-info list-unstyled"};function ot(e,n,r,u,t,a){const _=f("router-link"),p=f("toastComponent");return i(),l(b,null,[s("div",P,[s("h2",D,"訂單編號："+o(t.tempOrderInfo.id),1),s("div",E,[s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",t.tempOrderInfo.is_paid?"border-info":"border-danger"])},[t.tempOrderInfo.is_paid?(i(),l("span",V,"已付款")):(i(),l("span",W,"未付款"))],2),s("span",{class:m(["d-inline-block mb-3 rounded-pill py-1 px-3 border fw-bold",t.tempOrderInfo.is_shipping?"border-info":"border-danger"])},[t.tempOrderInfo.is_shipping?(i(),l("span",M,"已出貨")):(i(),l("span",j,"未出貨"))],2)]),s("div",q,[t.tempOrderInfo.products?(i(),l("div",Q,[s("div",R,[s("div",z,[s("div",F,[s("div",H,[s("div",U,[s("div",G,[J,s("p",K,"NT$ "+o(t.tempOrderInfo.total),1),t.tempOrderInfo.is_paid?c("",!0):(i(),l("button",{key:0,class:"btn btn-default",onClick:n[0]||(n[0]=d=>a.updateOrder(t.tempOrderInfo,"updatePaid"))},[h("更改為"),X]))])]),s("div",Y,[s("div",Z,[$,s("p",ss,o(Object.keys(t.tempOrderInfo.products).length),1),t.tempOrderInfo.is_shipping?c("",!0):(i(),l("button",{key:0,class:"btn btn-default",onClick:n[1]||(n[1]=d=>a.updateOrder(t.tempOrderInfo,"updateShipping"))},"出貨"))])])]),ts,s("div",os,[s("ul",es,[(i(!0),l(b,null,w(t.tempOrderInfo.products,d=>(i(),l("li",{key:d.id,class:"mb-3 pb-3 border-bottom"},[s("div",ns,[s("div",is,[g(_,{to:`/productinfo/${d.product.id}`,target:"_blank",class:"d-flex gap-3 link-hover-decoration fw-bold"},{default:y(()=>[s("div",{style:S([{height:"50px"},{backgroundImage:`url(${d.product.imageUrl})`}]),class:"bg-img-contain bg-img-center bg-img-norepeat ratio-1x1"},null,4),h(" "+o(d.product.title),1)]),_:2},1032,["to"])]),s("div",ls,[s("div",ds,[s("div",rs,[s("p",cs,"NT$ "+o(d.product.price.toLocaleString())+" x "+o(d.qty),1)]),s("div",as,[s("p",_s,"NT$ "+o(d.total.toLocaleString()),1)])])])])]))),128))]),s("div",ps,[hs,s("div",us,[s("div",fs,[ms,s("div",bs,[s("p",gs,"NT$ "+o(t.total.toLocaleString()),1),s("p",Os,"- "+o((t.total-t.tempOrderInfo.total).toLocaleString()),1)])]),vs,s("div",xs,[Is,s("div",ws,[s("p",ys,"NT$ "+o(t.tempOrderInfo.total.toLocaleString()),1)])])])])]),Ss,s("div",ks,[Bs,s("p",null,o(t.tempOrderInfo.message),1)])])]),s("div",Ts,[s("div",Cs,[Ls,s("ul",As,[t.tempOrderInfo.shipping_date?(i(),l("li",Ns,[s("p",Ps,o(new Date(t.tempOrderInfo.shipping_date*1e3).toLocaleString()),1),Ds])):c("",!0),t.tempOrderInfo.paid_date?(i(),l("li",Es,[s("p",Vs,o(new Date(t.tempOrderInfo.paid_date*1e3).toLocaleString()),1),Ws])):c("",!0),s("li",null,[s("p",Ms,o(new Date(t.tempOrderInfo.create_at*1e3).toLocaleString()),1),js])])])])])])):c("",!0),s("div",qs,[t.tempOrderInfo.user?(i(),l("div",Qs,[s("div",Rs,[s("div",zs,[Fs,Hs,s("div",Us,[s("p",Gs,o(t.tempOrderInfo.user.name),1),s("ul",Js,[s("li",null,o(t.tempOrderInfo.user.email),1),s("li",null,o(t.tempOrderInfo.user.tel),1),s("li",null,o(t.tempOrderInfo.user.address),1)])])])]),s("div",Ks,[s("div",Xs,[Ys,Zs,s("div",$s,[s("p",st,o(t.tempOrderInfo.user.name),1),s("ul",tt,[s("li",null,o(t.tempOrderInfo.user.address),1),s("li",null,o(t.tempOrderInfo.user.tel),1)])])])])])):c("",!0)])])]),g(p,{adminOrderState:t.toastState,adminOrderAction:t.doAction},null,8,["adminOrderState","adminOrderAction"])],64)}const rt=v(N,[["render",ot]]);export{rt as default};
