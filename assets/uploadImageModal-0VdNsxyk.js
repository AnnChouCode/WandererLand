import{M as c}from"./modal-dX0T1h_7.js";import{_ as m,o as r,c as d,b as e,Y as p,Q as h,R as g}from"./index-WNumrVw8.js";var _={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:u,VITE_PATH:f}=_,b={props:["isCover"],data(){return{modal:null,dropArea:null,accept:["jpg","jpeg","png"],imgUrl:""}},methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()},handleFile(n){const o=n.target.files[0];if(console.log(o),o.size/(1024*1024)>3)return this.$swal.fire({icon:"error",text:"請上傳 3MB 以內的圖檔"}),this.resetDropArea(),!1;const t=o.type.split("/")[1];if(!this.accept.find(s=>s===t))return this.$swal.fire({icon:"error",text:"僅限使用 jpg、jpeg 與 png 格式圖檔"}),this.resetDropArea(),!1;this.uploadImage(o)},uploadImage(n){const o=this.$loading.show(),a=new FormData;a.append("file-to-upload",n),this.axios.post(`${u}/api/${f}/admin/upload`,a).then(l=>{this.imgUrl=l.data.imageUrl}).catch(l=>{console.log(l),this.$swal.fire({icon:"error",text:l.response})}).finally(()=>{o.hide()})},resetDropArea(){this.dropArea.value=""},submitImgUrl(){this.isCover?this.$emit("submitImgUrl","imageUrl",this.imgUrl):this.$emit("submitImgUrl","imagesUrl",this.imgUrl),this.imgUrl="",this.closeModal()}},mounted(){this.modal=new c(this.$refs.uploadImageModal,{keyboard:!1,backdrop:"static"}),this.dropArea=this.$refs.dropArea}},v={ref:"uploadImageModal",class:"modal fade","aria-hidden":"true","aria-labelledby":"uploadImageModal",tabindex:"-1"},I={class:"modal-dialog modal-lg modal-dialog-centered"},M={class:"modal-content"},U={class:"modal-header"},y={key:0,class:"modal-title text-bold fw-bold"},x={key:1,class:"modal-title text-bold fw-bold"},w=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),A={class:"modal-body container"},k={class:"row g-3"},B={class:"col-12 col-md-4"},T={class:"drop-area ratio-1x1"},D={key:1},E={class:"col-12 col-md-8"},S=e("p",{class:"mb-1"},"僅限使用 jpg、jpeg 與 png 格式，檔案大小限制為 3MB 以下",-1),V=["accept"],j={class:"modal-footer"};function z(n,o,a,l,t,i){return r(),d("div",v,[e("div",I,[e("div",M,[e("div",U,[a.isCover?(r(),d("h5",y,"上傳封面")):(r(),d("h5",x,"上傳圖片")),w]),e("div",A,[e("div",k,[e("div",B,[e("div",T,[t.imgUrl?(r(),d("div",{key:0,style:p(`background-image:url(${t.imgUrl})`),class:"w-100 h-100 bg-img-contain bg-img-center bg-img-norepeat"},null,4)):(r(),d("p",D,"圖片預覽"))])]),e("div",E,[S,h(e("input",{class:"form-control mb-1",type:"text",placeholder:"請填入圖片網址","onUpdate:modelValue":o[0]||(o[0]=s=>t.imgUrl=s)},null,512),[[g,t.imgUrl]]),e("input",{class:"form-control",type:"file",ref:"dropArea",accept:t.accept,onChange:o[1]||(o[1]=(...s)=>i.handleFile&&i.handleFile(...s))},null,40,V)])])]),e("div",j,[e("button",{type:"button",class:"btn btn-dark",onClick:o[2]||(o[2]=(...s)=>i.submitImgUrl&&i.submitImgUrl(...s))},"送出")])])])],512)}const $=m(b,[["render",z]]);export{$ as u};
