import{q as u,s as f,u as c}from"./index-xxmhpSli.js";import{s as i}from"./statusStore-Kr_WM3ql.js";import{s as n}from"./sweetalert2.all-AGo5aliO.js";var g={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const d=u.useLoading(),{VITE_API:l,VITE_PATH:h}=g,$=f("cartStore",{state:()=>({cartsList:[],coupon_code:""}),actions:{addToCart(t,o){const s=d.show(),a=`${l}/api/${h}/cart`,e={data:{product_id:t,qty:o}};c.post(a,e).then(r=>{const{addMsg:p}=i();p("bi-bag-check","已更新購物車"),this.getCartsList()}).catch(r=>{n.fire({icon:"error",text:r.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{s.hide()})},getCartsList(){const t=d.show(),o=`${l}/api/${h}/cart`;c.get(o).then(s=>{this.cartsList=s.data.data}).catch(s=>{n.fire({icon:"error",text:s.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{t.hide()})},updateCart(t){const o=d.show(),s=`${l}/api/${h}/cart/${t.id}`,a={data:{product_id:t.product_id,qty:t.qty}};c.put(s,a).then(e=>{const{addMsg:r}=i();r("bi-bag-check","已更新購物車"),this.getCartsList()}).catch(e=>{n.fire({icon:"error",text:e.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{o.hide()})},deleteCartItem(t){const o=d.show(),s=`${l}/api/${h}/cart/${t}`;c.delete(s).then(a=>{const{addMsg:e}=i();e("bi-bag-check","已更新購物車"),this.getCartsList()}).catch(a=>{n.fire({icon:"error",text:a.response.data.message,confirmButtonColor:"#333333"})}).finally(()=>{o.hide()})},copyCouponCode(t){navigator.clipboard.writeText(t).then(()=>{const{addMsg:o}=i();o("bi-info-circle","已複製優惠碼"),this.coupon_code=t})},checkCoupon(t){const o=`${l}/api/${h}/coupon`;if(this.cartsList.total!==this.cartsList.final_total){const{addMsg:e}=i();e("bi-info-circle","已套用優惠碼");return}const s=d.show(),a={data:{code:t}};c.post(o,a).then(e=>{const{addMsg:r}=i();r("bi-info-circle","已套用優惠碼"),this.getCartsList()}).catch(e=>{n.fire({icon:"error",text:e.response.data.message})}).finally(()=>{s.hide()})}}});export{$ as c};
