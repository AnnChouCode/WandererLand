import{M as c}from"./modal-1JVlSD2_.js";import{_ as m,o as r,c as d,d as e,a1 as p,U as h,V as g}from"./index-f4rJqI21.js";var _={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const{VITE_API:u,VITE_PATH:f}=_,b={props:["isCover"],data(){return{modal:null,accept:["jpg","jpeg","png"],imgUrl:""}},methods:{openModal(){this.modal.show()},closeModal(){this.modal.hide()},handleFile(n){const s=n.target.files[0];if(s.size/(1024*1024)>3)return this.$swal.fire({icon:"error",text:"請上傳 3MB 以內的圖檔"}),this.resetDropArea(),!1;const t=s.type.split("/")[1];if(!this.accept.find(o=>o===t))return this.$swal.fire({icon:"error",text:"僅限使用 jpg、jpeg 與 png 格式圖檔"}),this.resetDropArea(),!1;this.uploadImage(s)},uploadImage(n){const s=this.$loading.show(),l=new FormData;l.append("file-to-upload",n),this.axios.post(`${u}/api/${f}/admin/upload`,l).then(a=>{this.imgUrl=a.data.imageUrl}).catch(a=>{console.log(a.response.data.message),this.$swal.fire({icon:"error",text:a.response})}).finally(()=>{s.hide()})},resetDropArea(){this.imgUrl="",this.$refs.dropArea.value=""},submitImgUrl(){this.isCover?this.$emit("submitImgUrl","imageUrl",this.imgUrl):this.$emit("submitImgUrl","imagesUrl",this.imgUrl),this.resetDropArea(),this.closeModal()}},mounted(){this.modal=new c(this.$refs.uploadImageModal,{keyboard:!1,backdrop:"static"})}},v={ref:"uploadImageModal",class:"modal fade","aria-hidden":"true","aria-labelledby":"uploadImageModal",tabindex:"-1"},I={class:"modal-dialog modal-lg modal-dialog-centered"},U={class:"modal-content"},M={class:"modal-header"},y={key:0,class:"modal-title text-bold fw-bold"},x={key:1,class:"modal-title text-bold fw-bold"},w=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),k={class:"modal-body container"},A={class:"row g-3"},B={class:"col-12 col-md-4"},D={class:"drop-area ratio-1x1"},T={key:1},E={class:"col-12 col-md-8"},S=e("p",{class:"mb-1"},"僅限使用 jpg、jpeg 與 png 格式，檔案大小限制為 3MB 以下",-1),V={ref:"imgForm"},j=["accept"],z={class:"modal-footer"};function C(n,s,l,a,t,i){return r(),d("div",v,[e("div",I,[e("div",U,[e("div",M,[l.isCover?(r(),d("h5",y,"上傳封面")):(r(),d("h5",x,"上傳圖片")),w]),e("div",k,[e("div",A,[e("div",B,[e("div",D,[t.imgUrl?(r(),d("div",{key:0,style:p(`background-image:url(${t.imgUrl})`),class:"w-100 h-100 bg-img-contain bg-img-center bg-img-norepeat"},null,4)):(r(),d("p",T,"圖片預覽"))])]),e("div",E,[S,e("form",V,[h(e("input",{class:"form-control mb-1",type:"text",placeholder:"請填入圖片網址","onUpdate:modelValue":s[0]||(s[0]=o=>t.imgUrl=o)},null,512),[[g,t.imgUrl]]),e("input",{class:"form-control",type:"file",ref:"dropArea",accept:t.accept,onChange:s[1]||(s[1]=(...o)=>i.handleFile&&i.handleFile(...o))},null,40,j)],512)])])]),e("div",z,[e("button",{type:"button",class:"btn btn-dark",onClick:s[2]||(s[2]=(...o)=>i.submitImgUrl&&i.submitImgUrl(...o))},"送出")])])])],512)}const $=m(b,[["render",C]]);export{$ as u};
