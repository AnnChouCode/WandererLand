import{u as y}from"./adminProductStore-JscpMs50.js";import{_ as U,M as V,r as p,o as r,c as d,b as e,h as C,T as g,F as h,d as v,e as i,f as I,n as m,t as M,w as P,v as q,U as B,g as S}from"./index-bOPoBINP.js";import{U as N}from"./UploadImageModal-OzWLv8BX.js";import"./sweetalert2.all-4uUzy6sD.js";import"./modal-iry2NQf5.js";import"./selector-engine-SiI6J4iV.js";var T={VITE_API:"https://vue3-course-api.hexschool.io/v2",VITE_PATH:"wandererland",BASE_URL:"/WandererLand/",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const b=y(),{VITE_API:z,VITE_PATH:A}=T,D={data(){return{isNewProduct:!1,tempProductInfo:{},tempGroupList:[],isCover:!1,swalInfoCheckWithBootstrapButtons:null}},methods:{getProductInfo(l,t){this.tempProductInfo=l[t]},chooseGroup(l){this.tempProductInfo.group=l},deleteImage(l,t){l==="imageUrl"?this.tempProductInfo.imageUrl="":l==="imagesUrl"?this.tempProductInfo.imagesUrl.splice(t,1):(this.tempProductInfo.imageUrl="",this.tempProductInfo.imagesUrl=[])},openImageModal(l){l==="isCover"?this.isCover=!0:this.isCover=!1,this.$refs.uploadImageModal.openModal()},getImgUrl(l,t){if(l==="imageUrl"){this.tempProductInfo.imageUrl=t;return}this.tempProductInfo.imagesUrl?this.tempProductInfo.imagesUrl.push(t):this.tempProductInfo.imagesUrl=[t]},updateProductInfo(){let l=`${z}/api/${A}/admin/product`;const t=this.isNewProduct?"post":"put";if(!this.tempProductInfo.imageUrl||!this.tempProductInfo.imagesUrl||this.tempProductInfo.imageUrl===""||!this.tempProductInfo.imagesUrl.length){this.swalInfoCheckWithBootstrapButtons.fire("圖片欄位為必填");return}this.isNewProduct||(l+=`/${this.tempProductInfo.id}`),this.isNewProduct&&(this.tempProductInfo.category="products",this.tempProductInfo.create_at=Math.floor(Date.now()/1e3)),this.tempProductInfo.size=this.tempProductInfo.size.replace("×","x"),this.axios[t](l,{data:this.tempProductInfo}).then(f=>{this.swalInfoCheckWithBootstrapButtons.fire(f.data.message),this.$router.push("/admin/products")}).catch(f=>{this.swalInfoCheckWithBootstrapButtons.fire({icon:"error",text:f.response.data.message,confirmButtonText:"確認"})})},async fetchData(l){try{if(await b.getAllProducts(),this.tempGroupList=[...b.groupList],!l)return;this.getProductInfo(b.allProducts,l)}catch(t){console.log(t.response.data.message)}}},computed:{...V(y)},components:{UploadImageModal:N},mounted(){const l=this.$route.params.id;l||(this.isNewProduct=!0),this.fetchData(l),this.swalInfoCheckWithBootstrapButtons=this.$swal.mixin({customClass:{confirmButton:"m-1 btn btn-default"},buttonsStyling:!1})}},E={class:"overflow-y-scroll scrollbar-y-hide vh-100"},L={key:0,class:"py-4 py-md-7 fw-bold"},W={key:1,class:"py-4 py-md-7 fw-bold"},j={class:"mb-7"},G=e("h5",{class:"mb-3 fw-bold has-required"},"商品圖片",-1),R={class:"row g-1 mb-3"},F={class:"col-6 col-md-2"},H={class:"ratio-1x1"},O={class:"position-relative border border-1 h-100"},J=e("i",{class:"bi bi-trash"},null,-1),K=[J],Q=e("div",{class:"position-absolute bottom-0 py-1 text-center text-white bg-dark opacity-75 w-100"}," 封面圖片 ",-1),X={key:2,class:"h-100"},Y=e("i",{class:"bi bi-image mb-2 text-default"},null,-1),Z=e("p",{class:"text-default"},"目前無封面",-1),$=[Y,Z],ee={class:"position-relative border border-1 h-100"},te=["onClick"],oe=e("i",{class:"bi bi-trash"},null,-1),se=[oe],le={class:"col-6 col-md-2"},ie=e("i",{class:"bi bi-trash me-2"},null,-1),ne=e("span",null,"刪除所有圖片",-1),re=[ie,ne],de=e("h5",{class:"mb-5 fw-bold"},"商品基本資訊",-1),ae=e("label",{for:"title",class:"form-label fw-bold has-required"},"商品名稱",-1),ce={class:"row g-5 g-md-1"},me={class:"col-md-6"},ue=e("label",{for:"artist",class:"form-label fw-bold has-required"},"藝術家",-1),pe={class:"col-md-6"},fe=e("label",{for:"size",class:"me-2 form-label fw-bold has-required"},"商品尺寸",-1),he={class:"row g-5 g-md-1"},be={class:"col-md-6"},_e=e("label",{for:"quantity",class:"me-2 form-label fw-bold"},"作品版數",-1),ge=e("span",{class:"fs-info text-info"},"若未填寫則不限版數",-1),ve={class:"col-md-6"},Ie=e("label",{for:"unit",class:"form-label fw-bold has-required"},"商品單位",-1),Pe=e("label",{for:"group",class:"form-label fw-bold has-required"},"商品分類",-1),ye={class:"d-flex align-items-center text-nowrap fs-info"},xe=e("span",{class:"text-info"},"點擊帶入分類：",-1),we={class:"d-flex gap-1 mb-0 flex-wrap"},ke=["onClick"],Ue={class:"row g-3 g-md-1"},Ve={class:"col-md-6"},Ce=e("label",{for:"origin_price",class:"form-label fw-bold has-required"},"原價",-1),Me={class:"col-md-6"},qe=e("label",{for:"price",class:"form-label fw-bold has-required"},"售價",-1),Be=e("label",{for:"content",class:"form-label fw-bold"},"說明內容",-1),Se={class:"form-check form-switch"},Ne={class:"form-check-label",for:"is_enabled"},Te={key:0},ze={key:1},Ae={class:"d-flex justify-content-end gap-2 pt-3"},De=e("button",{type:"submit",class:"btn btn-dark text-white"},"確認",-1);function Ee(l,t,f,Le,o,a){const c=p("v-field"),u=p("error-message"),x=p("router-link"),w=p("v-form"),k=p("UploadImageModal");return r(),d(h,null,[e("div",E,[o.isNewProduct?(r(),d("h2",L,"新增商品")):(r(),d("h2",W,"編輯商品")),e("div",null,[e("div",j,[G,e("div",R,[e("div",F,[e("div",H,[e("div",O,[o.tempProductInfo.imageUrl?(r(),d("button",{key:0,type:"button",class:"position-absolute top-0 end-0 d-flex justify-content-center align-items-center mt-2 me-2 btn btn-light",style:{width:"36px",height:"36px"},onClick:t[0]||(t[0]=n=>a.deleteImage("imageUrl",l.idx))},K)):C("",!0),Q,o.tempProductInfo.imageUrl?(r(),d("div",{key:1,style:g(`background-image:url(${o.tempProductInfo.imageUrl})`),class:"h-100 bg-img-contain bg-img-center bg-img-norepeat"},null,4)):(r(),d("div",X,[e("button",{onClick:t[1]||(t[1]=n=>a.openImageModal("isCover")),class:"d-flex flex-column align-items-center justify-content-center w-100 h-100 text-secondary btn btn-light rounded-0",type:"button"},$)]))])])]),(r(!0),d(h,null,v(o.tempProductInfo.imagesUrl,(n,s)=>(r(),d("div",{class:"col-6 col-md-2",key:s},[e("div",ee,[e("button",{type:"button",class:"position-absolute top-0 end-0 d-flex justify-content-center align-items-center mt-2 me-2 btn btn-light",style:{width:"36px",height:"36px"},onClick:_=>a.deleteImage("imagesUrl",s)},se,8,te),e("div",{style:g(`background-image:url(${n})`),class:"h-100 bg-img-contain bg-img-center bg-img-norepeat"},null,4)])]))),128)),e("div",le,[e("button",{onClick:t[2]||(t[2]=n=>a.openImageModal("inNotCover")),class:"d-flex align-items-center justify-content-center w-100 h-100 text-default btn btn-light rounded-0 ratio-1x1 border border-1",type:"button"}," 新增圖片 ")])]),e("button",{typs:"button",class:"p-0 btn text-danger",onClick:t[3]||(t[3]=(...n)=>a.deleteImage&&a.deleteImage(...n))},re)]),e("div",null,[de,i(w,{class:"d-flex flex-column gap-5",onSubmit:a.updateProductInfo},{default:I(({errors:n})=>[e("div",null,[ae,i(c,{type:"text",class:m(["form-control",{"is-invalid":n.名稱}]),placeholder:"請輸入商品名稱",modelValue:o.tempProductInfo.title,"onUpdate:modelValue":t[4]||(t[4]=s=>o.tempProductInfo.title=s),modelModifiers:{trim:!0},id:"title",name:"名稱",rules:"required"},null,8,["modelValue","class"]),i(u,{name:"名稱",class:"invalid-feedback"})]),e("div",ce,[e("div",me,[ue,i(c,{id:"artist",name:"藝術家",type:"text",class:m(["form-control",{"is-invalid":n.藝術家}]),placeholder:"請輸入藝術家名稱",rules:"required",modelValue:o.tempProductInfo.artist,"onUpdate:modelValue":t[5]||(t[5]=s=>o.tempProductInfo.artist=s),modelModifiers:{trim:!0}},null,8,["class","modelValue"]),i(u,{name:"藝術家",class:"invalid-feedback"})]),e("div",pe,[fe,i(c,{id:"size",name:"尺寸",type:"text",class:m(["form-control",{"is-invalid":n.size}]),placeholder:"請輸入商品尺寸",min:"0",modelValue:o.tempProductInfo.size,"onUpdate:modelValue":t[6]||(t[6]=s=>o.tempProductInfo.size=s)},null,8,["class","modelValue"]),i(u,{name:"尺寸",class:"invalid-feedback"})])]),e("div",he,[e("div",be,[_e,ge,i(c,{id:"quantity",name:"quantity",type:"number",class:m(["form-control",{"is-invalid":n.quantity}]),placeholder:"請輸入作品版數",min:"0",modelValue:o.tempProductInfo.quantity,"onUpdate:modelValue":t[7]||(t[7]=s=>o.tempProductInfo.quantity=s),modelModifiers:{number:!0,trim:!0}},null,8,["class","modelValue"])]),e("div",ve,[Ie,i(c,{id:"unit",name:"單位",type:"text",class:m(["form-control",{"is-invalid":n.unit}]),placeholder:"請輸入商品單位",rules:"required",modelValue:o.tempProductInfo.unit,"onUpdate:modelValue":t[8]||(t[8]=s=>o.tempProductInfo.unit=s),modelModifiers:{trim:!0}},null,8,["class","modelValue"]),i(u,{name:"單位",class:"invalid-feedback"})])]),e("div",null,[e("div",null,[Pe,i(c,{type:"text",id:"group",name:"分類",class:m(["form-control mb-1",{"is-invalid":n.分類}]),placeholder:"請輸入商品分類",rules:"required",modelValue:o.tempProductInfo.group,"onUpdate:modelValue":t[9]||(t[9]=s=>o.tempProductInfo.group=s),modelModifiers:{trim:!0}},null,8,["class","modelValue"]),i(u,{name:"分類",class:"invalid-feedback"})]),e("div",ye,[xe,e("div",we,[(r(!0),d(h,null,v(o.tempGroupList,(s,_)=>(r(),d("button",{type:"button",class:"btn btn-light rounded-pill py-1 fs-info text-info",value:"item",key:_,onClick:We=>a.chooseGroup(s)},M(s),9,ke))),128))])])]),e("div",Ue,[e("div",Ve,[Ce,i(c,{type:"number",id:"origin_price",name:"原價",class:m(["form-control",{"is-invalid":n.原價}]),placeholder:"請輸入原價",rules:"required",min:"0",modelValue:o.tempProductInfo.origin_price,"onUpdate:modelValue":t[10]||(t[10]=s=>o.tempProductInfo.origin_price=s),modelModifiers:{number:!0,trim:!0}},null,8,["class","modelValue"]),i(u,{name:"原價",class:"invalid-feedback"})]),e("div",Me,[qe,i(c,{type:"number",id:"price",name:"售價",class:m(["form-control",{"is-invalid":n.售價}]),placeholder:"請輸入商品售價",rules:"required",min:"0",modelValue:o.tempProductInfo.price,"onUpdate:modelValue":t[11]||(t[11]=s=>o.tempProductInfo.price=s),modelModifiers:{number:!0,trim:!0}},null,8,["class","modelValue"]),i(u,{name:"售價",class:"invalid-feedback"})])]),e("div",null,[Be,P(e("textarea",{type:"text",id:"content",class:"form-control",placeholder:"請輸入說明內容","onUpdate:modelValue":t[12]||(t[12]=s=>o.tempProductInfo.content=s),style:{height:"200px"}},null,512),[[q,o.tempProductInfo.content,void 0,{trim:!0}]])]),e("div",Se,[P(e("input",{class:"form-check-input",type:"checkbox",role:"switch",id:"is_enabled","onUpdate:modelValue":t[13]||(t[13]=s=>o.tempProductInfo.is_enabled=s)},null,512),[[B,o.tempProductInfo.is_enabled]]),e("label",Ne,[o.tempProductInfo.is_enabled?(r(),d("span",Te,"更改為未上架")):(r(),d("span",ze,"更改為已上架"))])]),e("div",Ae,[i(x,{to:"/admin/products",class:"btn btn-outline-dark"},{default:I(()=>[S("取消")]),_:1}),De])]),_:1},8,["onSubmit"])])])]),i(k,{ref:"uploadImageModal",onSubmitImgUrl:a.getImgUrl,"is-Cover":o.isCover},null,8,["onSubmitImgUrl","is-Cover"])],64)}const Je=U(D,[["render",Ee]]);export{Je as default};
